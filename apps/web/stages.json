[
  {
    "$set": {
      "values": {
        "$literal": {
          "000004000000": [
            "Første seminar"
          ],
          "000003000000": [
            "2023-03-23T23:13:15.858Z"
          ]
        }
      },
      "compute": {
        "$literal": [
          {
            "k": "0000000100a300010b000005",
            "v": [
              "og også her",
              {
                "n": true
              },
              "med flere afsnit"
            ]
          }
        ]
      },
      "config": {
        "$literal": []
      },
      "versions": {
        "$literal": {
          "000004000000": 1,
          "00010b000005": 2
        }
      },
      "cached": []
    }
  },
  {
    "$set": {
      "idString": {
        "$substrBytes": [
          {
            "$toString": "$$CURRENT._id"
          },
          12,
          12
        ]
      }
    }
  },
  {
    "$set": {
      "updates": {
        "$filter": {
          "input": [],
          "as": "r312",
          "cond": {
            "$in": [
              "$$r312.k",
              "$$CURRENT.compute.k"
            ]
          }
        }
      },
      "derivatives": [],
      "statics": {
        "$filter": {
          "input": {
            "$map": {
              "input": {
                "$objectToArray": "$$CURRENT.values"
              },
              "as": "r313",
              "in": {
                "k": {
                  "$toObjectId": {
                    "$concat": [
                      "$$CURRENT.idString",
                      "$$r313.k"
                    ]
                  }
                },
                "result": "$$r313.v"
              }
            }
          },
          "as": "r314",
          "cond": {
            "$not": {
              "$in": [
                "$$r314.k",
                "$$CURRENT.compute.k"
              ]
            }
          }
        }
      }
    }
  },
  {
    "$set": {
      "compute": {
        "$let": {
          "vars": {
            "size": {
              "$size": "$$CURRENT.compute"
            }
          },
          "in": {
            "$map": {
              "input": {
                "$range": [
                  0,
                  "$$size"
                ]
              },
              "as": "r315",
              "in": {
                "$mergeObjects": [
                  {
                    "$arrayElemAt": [
                      "$$CURRENT.compute",
                      "$$r315"
                    ]
                  },
                  {
                    "depth": {
                      "$subtract": [
                        "$$size",
                        "$$r315"
                      ]
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  },
  {
    "$set": {
      "compute": {
        "$filter": {
          "input": "$$CURRENT.compute",
          "as": "r316",
          "cond": {
            "$not": {
              "$in": [
                "$$r316.k",
                []
              ]
            }
          }
        }
      }
    }
  },
  {
    "$set": {
      "compute": {
        "$reduce": {
          "input": "$$CURRENT.compute",
          "initialValue": [],
          "in": {
            "$let": {
              "vars": {
                "r317": "$$value",
                "r318": "$$this"
              },
              "in": {
                "$concatArrays": [
                  "$$r317",
                  [
                    {
                      "$mergeObjects": [
                        "$$r318",
                        {
                          "$let": {
                            "vars": {
                              "result": {
                                "$reduce": {
                                  "input": "$$r318.v",
                                  "initialValue": {
                                    "value": [],
                                    "stack": [],
                                    "imports": [],
                                    "nested": [],
                                    "function": [],
                                    "updated": false
                                  },
                                  "in": {
                                    "$let": {
                                      "vars": {
                                        "r319": "$$value",
                                        "r320": "$$this"
                                      },
                                      "in": {
                                        "$let": {
                                          "vars": {
                                            "select": {
                                              "$cond": {
                                                "if": {
                                                  "$eq": [
                                                    {
                                                      "$type": "$$r320"
                                                    },
                                                    "object"
                                                  ]
                                                },
                                                "then": {
                                                  "$eq": [
                                                    {
                                                      "$type": "$$r320.f"
                                                    },
                                                    "string"
                                                  ]
                                                },
                                                "else": false
                                              }
                                            },
                                            "nested": {
                                              "$cond": {
                                                "if": {
                                                  "$or": [
                                                    {
                                                      "$eq": [
                                                        {
                                                          "$type": "$$r320.element"
                                                        },
                                                        "string"
                                                      ]
                                                    },
                                                    {
                                                      "$eq": [
                                                        {
                                                          "$type": "$$r320.folder"
                                                        },
                                                        "objectId"
                                                      ]
                                                    },
                                                    {
                                                      "$eq": [
                                                        {
                                                          "$type": "$$r320.field"
                                                        },
                                                        "objectId"
                                                      ]
                                                    }
                                                  ]
                                                },
                                                "then": [
                                                  {
                                                    "$substrBytes": [
                                                      {
                                                        "$toString": "$$r320.id"
                                                      },
                                                      12,
                                                      24
                                                    ]
                                                  }
                                                ],
                                                "else": []
                                              }
                                            }
                                          },
                                          "in": {
                                            "$let": {
                                              "vars": {
                                                "next": {
                                                  "$switch": {
                                                    "branches": [
                                                      {
                                                        "case": {
                                                          "$cond": {
                                                            "if": {
                                                              "$eq": [
                                                                {
                                                                  "$type": "$$r320"
                                                                },
                                                                "object"
                                                              ]
                                                            },
                                                            "then": {
                                                              "$eq": [
                                                                {
                                                                  "$type": "$$r320.element"
                                                                },
                                                                "string"
                                                              ]
                                                            },
                                                            "else": false
                                                          }
                                                        },
                                                        "then": {
                                                          "$concatArrays": [
                                                            [
                                                              {
                                                                "(": true
                                                              },
                                                              ""
                                                            ],
                                                            {
                                                              "$reduce": {
                                                                "input": {
                                                                  "$objectToArray": "$$r320.props"
                                                                },
                                                                "initialValue": [],
                                                                "in": {
                                                                  "$let": {
                                                                    "vars": {
                                                                      "r321": "$$value",
                                                                      "r322": "$$this"
                                                                    },
                                                                    "in": {
                                                                      "$concatArrays": [
                                                                        "$$r321",
                                                                        [
                                                                          {
                                                                            "field": {
                                                                              "$toObjectId": {
                                                                                "$concat": [
                                                                                  {
                                                                                    "$substrBytes": [
                                                                                      {
                                                                                        "$toString": "$$r320.id"
                                                                                      },
                                                                                      12,
                                                                                      24
                                                                                    ]
                                                                                  },
                                                                                  "$$r322.k"
                                                                                ]
                                                                              }
                                                                            },
                                                                            "ignore": {
                                                                              "$not": "$$r322.v"
                                                                            }
                                                                          }
                                                                        ]
                                                                      ]
                                                                    }
                                                                  }
                                                                }
                                                              }
                                                            },
                                                            [
                                                              "",
                                                              {
                                                                ")": true
                                                              }
                                                            ]
                                                          ]
                                                        }
                                                      },
                                                      {
                                                        "case": "$$select",
                                                        "then": {
                                                          "$concatArrays": [
                                                            [
                                                              {
                                                                "(": true
                                                              }
                                                            ],
                                                            {
                                                              "$reduce": {
                                                                "input": "$$r319.value",
                                                                "initialValue": [],
                                                                "in": {
                                                                  "$let": {
                                                                    "vars": {
                                                                      "r323": "$$value",
                                                                      "r324": "$$this"
                                                                    },
                                                                    "in": {
                                                                      "$reduce": {
                                                                        "input": "$$r324",
                                                                        "initialValue": "$$r323",
                                                                        "in": {
                                                                          "$let": {
                                                                            "vars": {
                                                                              "r325": "$$value",
                                                                              "r326": "$$this"
                                                                            },
                                                                            "in": {
                                                                              "$cond": {
                                                                                "if": {
                                                                                  "$cond": {
                                                                                    "if": {
                                                                                      "$eq": [
                                                                                        {
                                                                                          "$type": "$$r326"
                                                                                        },
                                                                                        "object"
                                                                                      ]
                                                                                    },
                                                                                    "then": {
                                                                                      "$eq": [
                                                                                        {
                                                                                          "$type": "$$r326.id"
                                                                                        },
                                                                                        "objectId"
                                                                                      ]
                                                                                    },
                                                                                    "else": false
                                                                                  }
                                                                                },
                                                                                "then": {
                                                                                  "$concatArrays": [
                                                                                    "$$r325",
                                                                                    [
                                                                                      {
                                                                                        "[": true
                                                                                      },
                                                                                      {
                                                                                        "field": {
                                                                                          "$toObjectId": {
                                                                                            "$concat": [
                                                                                              {
                                                                                                "$substrBytes": [
                                                                                                  {
                                                                                                    "$toString": "$$r326.id"
                                                                                                  },
                                                                                                  12,
                                                                                                  24
                                                                                                ]
                                                                                              },
                                                                                              "$$r320.f"
                                                                                            ]
                                                                                          }
                                                                                        }
                                                                                      },
                                                                                      {
                                                                                        "]": true
                                                                                      }
                                                                                    ]
                                                                                  ]
                                                                                },
                                                                                "else": "$$r325"
                                                                              }
                                                                            }
                                                                          }
                                                                        }
                                                                      }
                                                                    }
                                                                  }
                                                                }
                                                              }
                                                            },
                                                            [
                                                              {
                                                                ")": true
                                                              }
                                                            ]
                                                          ]
                                                        }
                                                      }
                                                    ],
                                                    "default": [
                                                      "$$r320"
                                                    ]
                                                  }
                                                },
                                                "acc": {
                                                  "$cond": {
                                                    "if": "$$select",
                                                    "then": {
                                                      "$mergeObjects": [
                                                        "$$r319",
                                                        {
                                                          "value": {
                                                            "$last": "$$r319.stack"
                                                          },
                                                          "stack": {
                                                            "$cond": {
                                                              "if": {
                                                                "$lte": [
                                                                  {
                                                                    "$size": "$$r319.stack"
                                                                  },
                                                                  1
                                                                ]
                                                              },
                                                              "then": [],
                                                              "else": {
                                                                "$slice": [
                                                                  "$$r319.stack",
                                                                  0,
                                                                  {
                                                                    "$subtract": [
                                                                      {
                                                                        "$size": "$$r319.stack"
                                                                      },
                                                                      1
                                                                    ]
                                                                  }
                                                                ]
                                                              }
                                                            }
                                                          },
                                                          "nested": {
                                                            "$setUnion": [
                                                              "$$r319.nested",
                                                              "$$nested"
                                                            ]
                                                          }
                                                        }
                                                      ]
                                                    },
                                                    "else": {
                                                      "$mergeObjects": [
                                                        "$$r319",
                                                        {
                                                          "nested": {
                                                            "$setUnion": [
                                                              "$$r319.nested",
                                                              "$$nested"
                                                            ]
                                                          }
                                                        }
                                                      ]
                                                    }
                                                  }
                                                }
                                              },
                                              "in": {
                                                "$reduce": {
                                                  "input": "$$next",
                                                  "initialValue": "$$acc",
                                                  "in": {
                                                    "$let": {
                                                      "vars": {
                                                        "r327": "$$value",
                                                        "r328": "$$this"
                                                      },
                                                      "in": {
                                                        "$let": {
                                                          "vars": {
                                                            "imp": {
                                                              "$cond": {
                                                                "if": {
                                                                  "$cond": {
                                                                    "if": {
                                                                      "$eq": [
                                                                        {
                                                                          "$type": "$$r328"
                                                                        },
                                                                        "object"
                                                                      ]
                                                                    },
                                                                    "then": {
                                                                      "$eq": [
                                                                        {
                                                                          "$type": "$$r328.field"
                                                                        },
                                                                        "objectId"
                                                                      ]
                                                                    },
                                                                    "else": false
                                                                  }
                                                                },
                                                                "then": "$$r328",
                                                                "else": null
                                                              }
                                                            }
                                                          },
                                                          "in": {
                                                            "$let": {
                                                              "vars": {
                                                                "args": {
                                                                  "$cond": {
                                                                    "if": {
                                                                      "$toBool": "$$imp.id"
                                                                    },
                                                                    "then": {
                                                                      "$map": {
                                                                        "input": {
                                                                          "$range": [
                                                                            0,
                                                                            2
                                                                          ]
                                                                        },
                                                                        "as": "r329",
                                                                        "in": {
                                                                          "$first": {
                                                                            "$filter": {
                                                                              "input": {
                                                                                "$concatArrays": [
                                                                                  "$$CURRENT.updates",
                                                                                  "$$r317",
                                                                                  "$$CURRENT.statics",
                                                                                  "$$CURRENT.derivatives"
                                                                                ]
                                                                              },
                                                                              "as": "r330",
                                                                              "cond": {
                                                                                "$eq": [
                                                                                  "$$r330.k",
                                                                                  {
                                                                                    "$toObjectId": {
                                                                                      "$concat": [
                                                                                        {
                                                                                          "$substrBytes": [
                                                                                            {
                                                                                              "$toString": "$$imp.id"
                                                                                            },
                                                                                            12,
                                                                                            24
                                                                                          ]
                                                                                        },
                                                                                        "00000000000",
                                                                                        {
                                                                                          "$toString": "$$r329"
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  }
                                                                                ]
                                                                              }
                                                                            }
                                                                          }
                                                                        }
                                                                      }
                                                                    },
                                                                    "else": [
                                                                      null
                                                                    ]
                                                                  }
                                                                },
                                                                "importedField": {
                                                                  "$cond": {
                                                                    "if": {
                                                                      "$toBool": "$$imp"
                                                                    },
                                                                    "then": {
                                                                      "$first": {
                                                                        "$filter": {
                                                                          "input": {
                                                                            "$concatArrays": [
                                                                              "$$CURRENT.updates",
                                                                              "$$r317",
                                                                              "$$CURRENT.statics",
                                                                              "$$CURRENT.derivatives"
                                                                            ]
                                                                          },
                                                                          "as": "r331",
                                                                          "cond": {
                                                                            "$eq": [
                                                                              "$$r331.k",
                                                                              "$$imp.field"
                                                                            ]
                                                                          }
                                                                        }
                                                                      }
                                                                    },
                                                                    "else": null
                                                                  }
                                                                }
                                                              },
                                                              "in": {
                                                                "$let": {
                                                                  "vars": {
                                                                    "next": {
                                                                      "$switch": {
                                                                        "branches": [
                                                                          {
                                                                            "case": {
                                                                              "$and": [
                                                                                {
                                                                                  "$toBool": "$$imp"
                                                                                },
                                                                                {
                                                                                  "$or": [
                                                                                    {
                                                                                      "$not": {
                                                                                        "$toBool": "$$importedField"
                                                                                      }
                                                                                    },
                                                                                    {
                                                                                      "$toBool": "$$imp.ignore"
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            },
                                                                            "then": []
                                                                          },
                                                                          {
                                                                            "case": {
                                                                              "$toBool": "$$importedField"
                                                                            },
                                                                            "then": {
                                                                              "$concatArrays": [
                                                                                [
                                                                                  {
                                                                                    "(": true
                                                                                  }
                                                                                ],
                                                                                {
                                                                                  "$cond": {
                                                                                    "if": {
                                                                                      "$anyElementTrue": "$$args"
                                                                                    },
                                                                                    "then": {
                                                                                      "$getField": {
                                                                                        "input": "$$importedField",
                                                                                        "field": "function"
                                                                                      }
                                                                                    },
                                                                                    "else": {
                                                                                      "$getField": {
                                                                                        "input": "$$importedField",
                                                                                        "field": "result"
                                                                                      }
                                                                                    }
                                                                                  }
                                                                                },
                                                                                [
                                                                                  {
                                                                                    ")": true
                                                                                  }
                                                                                ]
                                                                              ]
                                                                            }
                                                                          }
                                                                        ],
                                                                        "default": [
                                                                          "$$r328"
                                                                        ]
                                                                      }
                                                                    }
                                                                  },
                                                                  "in": {
                                                                    "$mergeObjects": [
                                                                      {
                                                                        "$reduce": {
                                                                          "input": "$$next",
                                                                          "initialValue": "$$r327",
                                                                          "in": {
                                                                            "$let": {
                                                                              "vars": {
                                                                                "r332": "$$value",
                                                                                "r333": "$$this"
                                                                              },
                                                                              "in": {
                                                                                "$cond": {
                                                                                  "if": {
                                                                                    "$eq": [
                                                                                      {
                                                                                        "$type": "$$r333"
                                                                                      },
                                                                                      "object"
                                                                                    ]
                                                                                  },
                                                                                  "then": {
                                                                                    "$switch": {
                                                                                      "branches": [
                                                                                        {
                                                                                          "case": {
                                                                                            "$isNumber": "$$r333.x"
                                                                                          },
                                                                                          "then": {
                                                                                            "$let": {
                                                                                              "vars": {
                                                                                                "arg": {
                                                                                                  "$arrayElemAt": [
                                                                                                    "$$args",
                                                                                                    "$$r333.x"
                                                                                                  ]
                                                                                                }
                                                                                              },
                                                                                              "in": {
                                                                                                "$mergeObjects": [
                                                                                                  "$$r332",
                                                                                                  {
                                                                                                    "value": {
                                                                                                      "$concatArrays": [
                                                                                                        "$$r332.value",
                                                                                                        {
                                                                                                          "$switch": {
                                                                                                            "branches": [
                                                                                                              {
                                                                                                                "case": {
                                                                                                                  "$toBool": "$$arg"
                                                                                                                },
                                                                                                                "then": [
                                                                                                                  "$$arg.result"
                                                                                                                ]
                                                                                                              },
                                                                                                              {
                                                                                                                "case": {
                                                                                                                  "$ne": [
                                                                                                                    {
                                                                                                                      "$type": "$$r333.value"
                                                                                                                    },
                                                                                                                    "missing"
                                                                                                                  ]
                                                                                                                },
                                                                                                                "then": [
                                                                                                                  [
                                                                                                                    "$$r333.value"
                                                                                                                  ]
                                                                                                                ]
                                                                                                              }
                                                                                                            ],
                                                                                                            "default": []
                                                                                                          }
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  }
                                                                                                ]
                                                                                              }
                                                                                            }
                                                                                          }
                                                                                        },
                                                                                        {
                                                                                          "case": {
                                                                                            "$eq": [
                                                                                              {
                                                                                                "$type": "$$r333.n"
                                                                                              },
                                                                                              "bool"
                                                                                            ]
                                                                                          },
                                                                                          "then": "$$r332"
                                                                                        },
                                                                                        {
                                                                                          "case": {
                                                                                            "$eq": [
                                                                                              {
                                                                                                "$type": "$$r333.filters"
                                                                                              },
                                                                                              "array"
                                                                                            ]
                                                                                          },
                                                                                          "then": "$$r332"
                                                                                        },
                                                                                        {
                                                                                          "case": {
                                                                                            "$in": [
                                                                                              "bool",
                                                                                              [
                                                                                                {
                                                                                                  "$type": "$$r333.("
                                                                                                },
                                                                                                {
                                                                                                  "$type": "$$r333.{"
                                                                                                },
                                                                                                {
                                                                                                  "$type": "$$r333.["
                                                                                                }
                                                                                              ]
                                                                                            ]
                                                                                          },
                                                                                          "then": {
                                                                                            "$mergeObjects": [
                                                                                              "$$r332",
                                                                                              {
                                                                                                "stack": {
                                                                                                  "$concatArrays": [
                                                                                                    "$$r332.stack",
                                                                                                    [
                                                                                                      "$$r332.value"
                                                                                                    ]
                                                                                                  ]
                                                                                                },
                                                                                                "value": []
                                                                                              }
                                                                                            ]
                                                                                          }
                                                                                        }
                                                                                      ],
                                                                                      "default": {
                                                                                        "$let": {
                                                                                          "vars": {
                                                                                            "operator": {
                                                                                              "$switch": {
                                                                                                "branches": [
                                                                                                  {
                                                                                                    "case": {
                                                                                                      "$eq": [
                                                                                                        {
                                                                                                          "$type": "$$r333.)"
                                                                                                        },
                                                                                                        "string"
                                                                                                      ]
                                                                                                    },
                                                                                                    "then": "$$r333.)"
                                                                                                  },
                                                                                                  {
                                                                                                    "case": {
                                                                                                      "$eq": [
                                                                                                        {
                                                                                                          "$type": "$$r333.}"
                                                                                                        },
                                                                                                        "bool"
                                                                                                      ]
                                                                                                    },
                                                                                                    "then": "}"
                                                                                                  },
                                                                                                  {
                                                                                                    "case": {
                                                                                                      "$eq": [
                                                                                                        {
                                                                                                          "$type": "$$r333.)"
                                                                                                        },
                                                                                                        "bool"
                                                                                                      ]
                                                                                                    },
                                                                                                    "then": ")"
                                                                                                  },
                                                                                                  {
                                                                                                    "case": {
                                                                                                      "$eq": [
                                                                                                        {
                                                                                                          "$type": "$$r333.]"
                                                                                                        },
                                                                                                        "bool"
                                                                                                      ]
                                                                                                    },
                                                                                                    "then": "]"
                                                                                                  }
                                                                                                ],
                                                                                                "default": null
                                                                                              }
                                                                                            }
                                                                                          },
                                                                                          "in": {
                                                                                            "$cond": {
                                                                                              "if": {
                                                                                                "$eq": [
                                                                                                  "$$operator",
                                                                                                  null
                                                                                                ]
                                                                                              },
                                                                                              "then": {
                                                                                                "$mergeObjects": [
                                                                                                  "$$r332",
                                                                                                  {
                                                                                                    "value": {
                                                                                                      "$concatArrays": [
                                                                                                        "$$r332.value",
                                                                                                        [
                                                                                                          [
                                                                                                            "$$r333"
                                                                                                          ]
                                                                                                        ]
                                                                                                      ]
                                                                                                    }
                                                                                                  }
                                                                                                ]
                                                                                              },
                                                                                              "else": {
                                                                                                "$mergeObjects": [
                                                                                                  "$$r332",
                                                                                                  {
                                                                                                    "value": {
                                                                                                      "$concatArrays": [
                                                                                                        {
                                                                                                          "$last": "$$r332.stack"
                                                                                                        },
                                                                                                        {
                                                                                                          "$switch": {
                                                                                                            "branches": [
                                                                                                              {
                                                                                                                "case": {
                                                                                                                  "$eq": [
                                                                                                                    "$$operator",
                                                                                                                    "root"
                                                                                                                  ]
                                                                                                                },
                                                                                                                "then": "$$r332.value"
                                                                                                              },
                                                                                                              {
                                                                                                                "case": {
                                                                                                                  "$in": [
                                                                                                                    "$$operator",
                                                                                                                    [
                                                                                                                      ")",
                                                                                                                      "]"
                                                                                                                    ]
                                                                                                                  ]
                                                                                                                },
                                                                                                                "then": {
                                                                                                                  "$let": {
                                                                                                                    "vars": {
                                                                                                                      "spread": {
                                                                                                                        "$reduce": {
                                                                                                                          "input": "$$r332.value",
                                                                                                                          "initialValue": [],
                                                                                                                          "in": {
                                                                                                                            "$let": {
                                                                                                                              "vars": {
                                                                                                                                "r334": "$$value",
                                                                                                                                "r335": "$$this"
                                                                                                                              },
                                                                                                                              "in": {
                                                                                                                                "$reduce": {
                                                                                                                                  "input": "$$r335",
                                                                                                                                  "initialValue": "$$r334",
                                                                                                                                  "in": {
                                                                                                                                    "$let": {
                                                                                                                                      "vars": {
                                                                                                                                        "r336": "$$value",
                                                                                                                                        "r337": "$$this"
                                                                                                                                      },
                                                                                                                                      "in": {
                                                                                                                                        "$concatArrays": [
                                                                                                                                          "$$r336",
                                                                                                                                          [
                                                                                                                                            {
                                                                                                                                              "$cond": {
                                                                                                                                                "if": {
                                                                                                                                                  "$isArray": "$$r337"
                                                                                                                                                },
                                                                                                                                                "then": {
                                                                                                                                                  "$cond": {
                                                                                                                                                    "if": {
                                                                                                                                                      "$eq": [
                                                                                                                                                        {
                                                                                                                                                          "$size": "$$r337"
                                                                                                                                                        },
                                                                                                                                                        1
                                                                                                                                                      ]
                                                                                                                                                    },
                                                                                                                                                    "then": {
                                                                                                                                                      "$first": "$$r337"
                                                                                                                                                    },
                                                                                                                                                    "else": "$$r337"
                                                                                                                                                  }
                                                                                                                                                },
                                                                                                                                                "else": "$$r337"
                                                                                                                                              }
                                                                                                                                            }
                                                                                                                                          ]
                                                                                                                                        ]
                                                                                                                                      }
                                                                                                                                    }
                                                                                                                                  }
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        }
                                                                                                                      }
                                                                                                                    },
                                                                                                                    "in": {
                                                                                                                      "$cond": {
                                                                                                                        "if": {
                                                                                                                          "$eq": [
                                                                                                                            "$$operator",
                                                                                                                            "]"
                                                                                                                          ]
                                                                                                                        },
                                                                                                                        "then": [
                                                                                                                          [
                                                                                                                            "$$spread"
                                                                                                                          ]
                                                                                                                        ],
                                                                                                                        "else": [
                                                                                                                          "$$spread"
                                                                                                                        ]
                                                                                                                      }
                                                                                                                    }
                                                                                                                  }
                                                                                                                }
                                                                                                              },
                                                                                                              {
                                                                                                                "case": {
                                                                                                                  "$eq": [
                                                                                                                    "$$operator",
                                                                                                                    "}"
                                                                                                                  ]
                                                                                                                },
                                                                                                                "then": [
                                                                                                                  {
                                                                                                                    "$filter": {
                                                                                                                      "input": {
                                                                                                                        "$reduce": {
                                                                                                                          "input": "$$r332.value",
                                                                                                                          "initialValue": [
                                                                                                                            ""
                                                                                                                          ],
                                                                                                                          "in": {
                                                                                                                            "$let": {
                                                                                                                              "vars": {
                                                                                                                                "r338": "$$value",
                                                                                                                                "r339": "$$this"
                                                                                                                              },
                                                                                                                              "in": {
                                                                                                                                "$getField": {
                                                                                                                                  "input": {
                                                                                                                                    "$reduce": {
                                                                                                                                      "input": "$$r339",
                                                                                                                                      "initialValue": {
                                                                                                                                        "v": "$$r338",
                                                                                                                                        "i": 0
                                                                                                                                      },
                                                                                                                                      "in": {
                                                                                                                                        "$let": {
                                                                                                                                          "vars": {
                                                                                                                                            "r340": "$$value",
                                                                                                                                            "r341": "$$this"
                                                                                                                                          },
                                                                                                                                          "in": {
                                                                                                                                            "v": {
                                                                                                                                              "$cond": {
                                                                                                                                                "if": {
                                                                                                                                                  "$in": [
                                                                                                                                                    {
                                                                                                                                                      "$type": "$$r341"
                                                                                                                                                    },
                                                                                                                                                    [
                                                                                                                                                      "object",
                                                                                                                                                      "array"
                                                                                                                                                    ]
                                                                                                                                                  ]
                                                                                                                                                },
                                                                                                                                                "then": {
                                                                                                                                                  "$cond": {
                                                                                                                                                    "if": {
                                                                                                                                                      "$eq": [
                                                                                                                                                        {
                                                                                                                                                          "$last": "$$r340.v"
                                                                                                                                                        },
                                                                                                                                                        ""
                                                                                                                                                      ]
                                                                                                                                                    },
                                                                                                                                                    "then": "$$r340.v",
                                                                                                                                                    "else": {
                                                                                                                                                      "$concatArrays": [
                                                                                                                                                        "$$r340.v",
                                                                                                                                                        [
                                                                                                                                                          ""
                                                                                                                                                        ]
                                                                                                                                                      ]
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                },
                                                                                                                                                "else": {
                                                                                                                                                  "$cond": {
                                                                                                                                                    "if": {
                                                                                                                                                      "$gt": [
                                                                                                                                                        "$$r340.i",
                                                                                                                                                        0
                                                                                                                                                      ]
                                                                                                                                                    },
                                                                                                                                                    "then": {
                                                                                                                                                      "$concatArrays": [
                                                                                                                                                        "$$r340.v",
                                                                                                                                                        [
                                                                                                                                                          {
                                                                                                                                                            "$toString": "$$r341"
                                                                                                                                                          }
                                                                                                                                                        ]
                                                                                                                                                      ]
                                                                                                                                                    },
                                                                                                                                                    "else": {
                                                                                                                                                      "$concatArrays": [
                                                                                                                                                        {
                                                                                                                                                          "$cond": {
                                                                                                                                                            "if": {
                                                                                                                                                              "$lte": [
                                                                                                                                                                {
                                                                                                                                                                  "$size": "$$r340.v"
                                                                                                                                                                },
                                                                                                                                                                1
                                                                                                                                                              ]
                                                                                                                                                            },
                                                                                                                                                            "then": [],
                                                                                                                                                            "else": {
                                                                                                                                                              "$slice": [
                                                                                                                                                                "$$r340.v",
                                                                                                                                                                0,
                                                                                                                                                                {
                                                                                                                                                                  "$subtract": [
                                                                                                                                                                    {
                                                                                                                                                                      "$size": "$$r340.v"
                                                                                                                                                                    },
                                                                                                                                                                    1
                                                                                                                                                                  ]
                                                                                                                                                                }
                                                                                                                                                              ]
                                                                                                                                                            }
                                                                                                                                                          }
                                                                                                                                                        },
                                                                                                                                                        [
                                                                                                                                                          {
                                                                                                                                                            "$concat": [
                                                                                                                                                              {
                                                                                                                                                                "$last": "$$r340.v"
                                                                                                                                                              },
                                                                                                                                                              {
                                                                                                                                                                "$toString": "$$r341"
                                                                                                                                                              }
                                                                                                                                                            ]
                                                                                                                                                          }
                                                                                                                                                        ]
                                                                                                                                                      ]
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                }
                                                                                                                                              }
                                                                                                                                            },
                                                                                                                                            "i": {
                                                                                                                                              "$add": [
                                                                                                                                                0,
                                                                                                                                                "$$r340.i",
                                                                                                                                                1
                                                                                                                                              ]
                                                                                                                                            }
                                                                                                                                          }
                                                                                                                                        }
                                                                                                                                      }
                                                                                                                                    }
                                                                                                                                  },
                                                                                                                                  "field": "v"
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        }
                                                                                                                      },
                                                                                                                      "as": "r342",
                                                                                                                      "cond": {
                                                                                                                        "$ne": [
                                                                                                                          "$$r342",
                                                                                                                          ""
                                                                                                                        ]
                                                                                                                      }
                                                                                                                    }
                                                                                                                  }
                                                                                                                ]
                                                                                                              },
                                                                                                              {
                                                                                                                "case": {
                                                                                                                  "$eq": [
                                                                                                                    "$$operator",
                                                                                                                    "sum"
                                                                                                                  ]
                                                                                                                },
                                                                                                                "then": []
                                                                                                              },
                                                                                                              {
                                                                                                                "case": {
                                                                                                                  "$eq": [
                                                                                                                    "$$operator",
                                                                                                                    "filter"
                                                                                                                  ]
                                                                                                                },
                                                                                                                "then": []
                                                                                                              }
                                                                                                            ],
                                                                                                            "default": {
                                                                                                              "$let": {
                                                                                                                "vars": {
                                                                                                                  "combinations": {
                                                                                                                    "$reduce": {
                                                                                                                      "input": {
                                                                                                                        "$reduce": {
                                                                                                                          "input": "$$r332.value",
                                                                                                                          "initialValue": [],
                                                                                                                          "in": {
                                                                                                                            "$let": {
                                                                                                                              "vars": {
                                                                                                                                "r343": "$$value",
                                                                                                                                "r344": "$$this"
                                                                                                                              },
                                                                                                                              "in": {
                                                                                                                                "$concatArrays": [
                                                                                                                                  "$$r343",
                                                                                                                                  [
                                                                                                                                    {
                                                                                                                                      "$cond": {
                                                                                                                                        "if": {
                                                                                                                                          "$isArray": {
                                                                                                                                            "$first": "$$r344"
                                                                                                                                          }
                                                                                                                                        },
                                                                                                                                        "then": {
                                                                                                                                          "$first": "$$r344"
                                                                                                                                        },
                                                                                                                                        "else": "$$r344"
                                                                                                                                      }
                                                                                                                                    }
                                                                                                                                  ]
                                                                                                                                ]
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        }
                                                                                                                      },
                                                                                                                      "initialValue": [
                                                                                                                        []
                                                                                                                      ],
                                                                                                                      "in": {
                                                                                                                        "$let": {
                                                                                                                          "vars": {
                                                                                                                            "r345": "$$value",
                                                                                                                            "r346": "$$this"
                                                                                                                          },
                                                                                                                          "in": {
                                                                                                                            "$reduce": {
                                                                                                                              "input": "$$r346",
                                                                                                                              "initialValue": [],
                                                                                                                              "in": {
                                                                                                                                "$let": {
                                                                                                                                  "vars": {
                                                                                                                                    "r347": "$$value",
                                                                                                                                    "r348": "$$this"
                                                                                                                                  },
                                                                                                                                  "in": {
                                                                                                                                    "$concatArrays": [
                                                                                                                                      "$$r347",
                                                                                                                                      {
                                                                                                                                        "$map": {
                                                                                                                                          "input": "$$r345",
                                                                                                                                          "as": "r349",
                                                                                                                                          "in": {
                                                                                                                                            "$concatArrays": [
                                                                                                                                              [],
                                                                                                                                              "$$r349",
                                                                                                                                              [
                                                                                                                                                "$$r348"
                                                                                                                                              ]
                                                                                                                                            ]
                                                                                                                                          }
                                                                                                                                        }
                                                                                                                                      }
                                                                                                                                    ]
                                                                                                                                  }
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        }
                                                                                                                      }
                                                                                                                    }
                                                                                                                  }
                                                                                                                },
                                                                                                                "in": {
                                                                                                                  "$switch": {
                                                                                                                    "branches": [
                                                                                                                      {
                                                                                                                        "case": {
                                                                                                                          "$eq": [
                                                                                                                            "$$operator",
                                                                                                                            "in"
                                                                                                                          ]
                                                                                                                        },
                                                                                                                        "then": [
                                                                                                                          [
                                                                                                                            {
                                                                                                                              "$reduce": {
                                                                                                                                "input": "$$combinations",
                                                                                                                                "initialValue": false,
                                                                                                                                "in": {
                                                                                                                                  "$let": {
                                                                                                                                    "vars": {
                                                                                                                                      "r350": "$$value",
                                                                                                                                      "r351": "$$this"
                                                                                                                                    },
                                                                                                                                    "in": {
                                                                                                                                      "$or": [
                                                                                                                                        "$$r350",
                                                                                                                                        {
                                                                                                                                          "$eq": [
                                                                                                                                            {
                                                                                                                                              "$arrayElemAt": [
                                                                                                                                                "$$r351",
                                                                                                                                                0
                                                                                                                                              ]
                                                                                                                                            },
                                                                                                                                            {
                                                                                                                                              "$arrayElemAt": [
                                                                                                                                                "$$r351",
                                                                                                                                                1
                                                                                                                                              ]
                                                                                                                                            }
                                                                                                                                          ]
                                                                                                                                        }
                                                                                                                                      ]
                                                                                                                                    }
                                                                                                                                  }
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          ]
                                                                                                                        ]
                                                                                                                      },
                                                                                                                      {
                                                                                                                        "case": {
                                                                                                                          "$eq": [
                                                                                                                            "$$operator",
                                                                                                                            "concat"
                                                                                                                          ]
                                                                                                                        },
                                                                                                                        "then": [
                                                                                                                          {
                                                                                                                            "$reduce": {
                                                                                                                              "input": "$$combinations",
                                                                                                                              "initialValue": [],
                                                                                                                              "in": {
                                                                                                                                "$let": {
                                                                                                                                  "vars": {
                                                                                                                                    "r352": "$$value",
                                                                                                                                    "r353": "$$this"
                                                                                                                                  },
                                                                                                                                  "in": {
                                                                                                                                    "$concatArrays": [
                                                                                                                                      "$$r352",
                                                                                                                                      {
                                                                                                                                        "$reduce": {
                                                                                                                                          "input": "$$r353",
                                                                                                                                          "initialValue": [],
                                                                                                                                          "in": {
                                                                                                                                            "$let": {
                                                                                                                                              "vars": {
                                                                                                                                                "r354": "$$value",
                                                                                                                                                "r355": "$$this"
                                                                                                                                              },
                                                                                                                                              "in": {
                                                                                                                                                "$cond": {
                                                                                                                                                  "if": {
                                                                                                                                                    "$and": [
                                                                                                                                                      {
                                                                                                                                                        "$or": [
                                                                                                                                                          {
                                                                                                                                                            "$isNumber": "$$r355"
                                                                                                                                                          },
                                                                                                                                                          {
                                                                                                                                                            "$eq": [
                                                                                                                                                              {
                                                                                                                                                                "$type": "$$r355"
                                                                                                                                                              },
                                                                                                                                                              "string"
                                                                                                                                                            ]
                                                                                                                                                          }
                                                                                                                                                        ]
                                                                                                                                                      },
                                                                                                                                                      {
                                                                                                                                                        "$or": [
                                                                                                                                                          {
                                                                                                                                                            "$isNumber": {
                                                                                                                                                              "$last": "$$r354"
                                                                                                                                                            }
                                                                                                                                                          },
                                                                                                                                                          {
                                                                                                                                                            "$eq": [
                                                                                                                                                              {
                                                                                                                                                                "$type": {
                                                                                                                                                                  "$last": "$$r354"
                                                                                                                                                                }
                                                                                                                                                              },
                                                                                                                                                              "string"
                                                                                                                                                            ]
                                                                                                                                                          }
                                                                                                                                                        ]
                                                                                                                                                      }
                                                                                                                                                    ]
                                                                                                                                                  },
                                                                                                                                                  "then": {
                                                                                                                                                    "$concatArrays": [
                                                                                                                                                      {
                                                                                                                                                        "$cond": {
                                                                                                                                                          "if": {
                                                                                                                                                            "$lte": [
                                                                                                                                                              {
                                                                                                                                                                "$size": "$$r354"
                                                                                                                                                              },
                                                                                                                                                              1
                                                                                                                                                            ]
                                                                                                                                                          },
                                                                                                                                                          "then": [],
                                                                                                                                                          "else": {
                                                                                                                                                            "$slice": [
                                                                                                                                                              "$$r354",
                                                                                                                                                              0,
                                                                                                                                                              {
                                                                                                                                                                "$subtract": [
                                                                                                                                                                  {
                                                                                                                                                                    "$size": "$$r354"
                                                                                                                                                                  },
                                                                                                                                                                  1
                                                                                                                                                                ]
                                                                                                                                                              }
                                                                                                                                                            ]
                                                                                                                                                          }
                                                                                                                                                        }
                                                                                                                                                      },
                                                                                                                                                      [
                                                                                                                                                        {
                                                                                                                                                          "$concat": [
                                                                                                                                                            {
                                                                                                                                                              "$toString": {
                                                                                                                                                                "$last": "$$r354"
                                                                                                                                                              }
                                                                                                                                                            },
                                                                                                                                                            {
                                                                                                                                                              "$toString": "$$r355"
                                                                                                                                                            }
                                                                                                                                                          ]
                                                                                                                                                        }
                                                                                                                                                      ]
                                                                                                                                                    ]
                                                                                                                                                  },
                                                                                                                                                  "else": {
                                                                                                                                                    "$concatArrays": [
                                                                                                                                                      "$$r354",
                                                                                                                                                      [
                                                                                                                                                        "$$r355"
                                                                                                                                                      ]
                                                                                                                                                    ]
                                                                                                                                                  }
                                                                                                                                                }
                                                                                                                                              }
                                                                                                                                            }
                                                                                                                                          }
                                                                                                                                        }
                                                                                                                                      }
                                                                                                                                    ]
                                                                                                                                  }
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        ]
                                                                                                                      },
                                                                                                                      {
                                                                                                                        "case": {
                                                                                                                          "$in": [
                                                                                                                            "$$operator",
                                                                                                                            [
                                                                                                                              "url",
                                                                                                                              "slug"
                                                                                                                            ]
                                                                                                                          ]
                                                                                                                        },
                                                                                                                        "then": [
                                                                                                                          {
                                                                                                                            "$map": {
                                                                                                                              "input": "$$combinations",
                                                                                                                              "as": "r356",
                                                                                                                              "in": {
                                                                                                                                "$toLower": {
                                                                                                                                  "$reduce": {
                                                                                                                                    "input": "$$r356",
                                                                                                                                    "initialValue": "",
                                                                                                                                    "in": {
                                                                                                                                      "$let": {
                                                                                                                                        "vars": {
                                                                                                                                          "r357": "$$value",
                                                                                                                                          "r358": "$$this"
                                                                                                                                        },
                                                                                                                                        "in": {
                                                                                                                                          "$concat": [
                                                                                                                                            "$$r357",
                                                                                                                                            {
                                                                                                                                              "$switch": {
                                                                                                                                                "branches": [
                                                                                                                                                  {
                                                                                                                                                    "case": {
                                                                                                                                                      "$isNumber": "$$r358"
                                                                                                                                                    },
                                                                                                                                                    "then": {
                                                                                                                                                      "$toString": "$$r358"
                                                                                                                                                    }
                                                                                                                                                  },
                                                                                                                                                  {
                                                                                                                                                    "case": {
                                                                                                                                                      "$eq": [
                                                                                                                                                        {
                                                                                                                                                          "$type": "$$r358"
                                                                                                                                                        },
                                                                                                                                                        "string"
                                                                                                                                                      ]
                                                                                                                                                    },
                                                                                                                                                    "then": {
                                                                                                                                                      "$concat": [
                                                                                                                                                        {
                                                                                                                                                          "$cond": {
                                                                                                                                                            "if": {
                                                                                                                                                              "$and": [
                                                                                                                                                                {
                                                                                                                                                                  "$eq": [
                                                                                                                                                                    "$$operator",
                                                                                                                                                                    "url"
                                                                                                                                                                  ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                  "$ne": [
                                                                                                                                                                    "$$r358",
                                                                                                                                                                    ""
                                                                                                                                                                  ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                  "$ne": [
                                                                                                                                                                    "$$r357",
                                                                                                                                                                    ""
                                                                                                                                                                  ]
                                                                                                                                                                }
                                                                                                                                                              ]
                                                                                                                                                            },
                                                                                                                                                            "then": "/",
                                                                                                                                                            "else": ""
                                                                                                                                                          }
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                          "$reduce": {
                                                                                                                                                            "input": {
                                                                                                                                                              "$regexFindAll": {
                                                                                                                                                                "input": "$$r358",
                                                                                                                                                                "regex": {
                                                                                                                                                                  "$cond": {
                                                                                                                                                                    "if": {
                                                                                                                                                                      "$eq": [
                                                                                                                                                                        "$$operator",
                                                                                                                                                                        "url"
                                                                                                                                                                      ]
                                                                                                                                                                    },
                                                                                                                                                                    "then": "[^\\w\\-\\*\\/]",
                                                                                                                                                                    "else": "[^\\w\\-]"
                                                                                                                                                                  }
                                                                                                                                                                },
                                                                                                                                                                "options": "i"
                                                                                                                                                              }
                                                                                                                                                            },
                                                                                                                                                            "initialValue": "$$r358",
                                                                                                                                                            "in": {
                                                                                                                                                              "$let": {
                                                                                                                                                                "vars": {
                                                                                                                                                                  "r359": "$$value",
                                                                                                                                                                  "r360": "$$this"
                                                                                                                                                                },
                                                                                                                                                                "in": {
                                                                                                                                                                  "$replaceOne": {
                                                                                                                                                                    "input": "$$r359",
                                                                                                                                                                    "find": "$$r360.match",
                                                                                                                                                                    "replacement": {
                                                                                                                                                                      "$let": {
                                                                                                                                                                        "vars": {
                                                                                                                                                                          "repl": {
                                                                                                                                                                            "$filter": {
                                                                                                                                                                              "input": [
                                                                                                                                                                                [
                                                                                                                                                                                  " ",
                                                                                                                                                                                  "-"
                                                                                                                                                                                ],
                                                                                                                                                                                [
                                                                                                                                                                                  "Æ",
                                                                                                                                                                                  "ae"
                                                                                                                                                                                ],
                                                                                                                                                                                [
                                                                                                                                                                                  "Ø",
                                                                                                                                                                                  "oe"
                                                                                                                                                                                ],
                                                                                                                                                                                [
                                                                                                                                                                                  "Å",
                                                                                                                                                                                  "aa"
                                                                                                                                                                                ],
                                                                                                                                                                                [
                                                                                                                                                                                  "æ",
                                                                                                                                                                                  "ae"
                                                                                                                                                                                ],
                                                                                                                                                                                [
                                                                                                                                                                                  "ø",
                                                                                                                                                                                  "oe"
                                                                                                                                                                                ],
                                                                                                                                                                                [
                                                                                                                                                                                  "å",
                                                                                                                                                                                  "aa"
                                                                                                                                                                                ]
                                                                                                                                                                              ],
                                                                                                                                                                              "as": "r361",
                                                                                                                                                                              "cond": {
                                                                                                                                                                                "$eq": [
                                                                                                                                                                                  "$$r360.match",
                                                                                                                                                                                  {
                                                                                                                                                                                    "$first": "$$r361"
                                                                                                                                                                                  }
                                                                                                                                                                                ]
                                                                                                                                                                              }
                                                                                                                                                                            }
                                                                                                                                                                          }
                                                                                                                                                                        },
                                                                                                                                                                        "in": {
                                                                                                                                                                          "$cond": {
                                                                                                                                                                            "if": {
                                                                                                                                                                              "$eq": [
                                                                                                                                                                                {
                                                                                                                                                                                  "$size": "$$repl"
                                                                                                                                                                                },
                                                                                                                                                                                1
                                                                                                                                                                              ]
                                                                                                                                                                            },
                                                                                                                                                                            "then": {
                                                                                                                                                                              "$last": {
                                                                                                                                                                                "$first": "$$repl"
                                                                                                                                                                              }
                                                                                                                                                                            },
                                                                                                                                                                            "else": ""
                                                                                                                                                                          }
                                                                                                                                                                        }
                                                                                                                                                                      }
                                                                                                                                                                    }
                                                                                                                                                                  }
                                                                                                                                                                }
                                                                                                                                                              }
                                                                                                                                                            }
                                                                                                                                                          }
                                                                                                                                                        }
                                                                                                                                                      ]
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                ],
                                                                                                                                                "default": ""
                                                                                                                                              }
                                                                                                                                            }
                                                                                                                                          ]
                                                                                                                                        }
                                                                                                                                      }
                                                                                                                                    }
                                                                                                                                  }
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        ]
                                                                                                                      },
                                                                                                                      {
                                                                                                                        "case": {
                                                                                                                          "$eq": [
                                                                                                                            "$$operator",
                                                                                                                            "="
                                                                                                                          ]
                                                                                                                        },
                                                                                                                        "then": [
                                                                                                                          {
                                                                                                                            "$map": {
                                                                                                                              "input": "$$combinations",
                                                                                                                              "as": "r362",
                                                                                                                              "in": {
                                                                                                                                "$eq": [
                                                                                                                                  {
                                                                                                                                    "$arrayElemAt": [
                                                                                                                                      "$$r362",
                                                                                                                                      0
                                                                                                                                    ]
                                                                                                                                  },
                                                                                                                                  {
                                                                                                                                    "$arrayElemAt": [
                                                                                                                                      "$$r362",
                                                                                                                                      1
                                                                                                                                    ]
                                                                                                                                  }
                                                                                                                                ]
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        ]
                                                                                                                      },
                                                                                                                      {
                                                                                                                        "case": {
                                                                                                                          "$in": [
                                                                                                                            "$$operator",
                                                                                                                            [
                                                                                                                              "+",
                                                                                                                              "-"
                                                                                                                            ]
                                                                                                                          ]
                                                                                                                        },
                                                                                                                        "then": [
                                                                                                                          {
                                                                                                                            "$map": {
                                                                                                                              "input": "$$combinations",
                                                                                                                              "as": "r363",
                                                                                                                              "in": {
                                                                                                                                "$reduce": {
                                                                                                                                  "input": {
                                                                                                                                    "$slice": [
                                                                                                                                      "$$r363",
                                                                                                                                      1,
                                                                                                                                      {
                                                                                                                                        "$subtract": [
                                                                                                                                          {
                                                                                                                                            "$size": "$$r363"
                                                                                                                                          },
                                                                                                                                          1
                                                                                                                                        ]
                                                                                                                                      }
                                                                                                                                    ]
                                                                                                                                  },
                                                                                                                                  "initialValue": {
                                                                                                                                    "$cond": {
                                                                                                                                      "if": {
                                                                                                                                        "$isNumber": {
                                                                                                                                          "$first": "$$r363"
                                                                                                                                        }
                                                                                                                                      },
                                                                                                                                      "then": {
                                                                                                                                        "$first": "$$r363"
                                                                                                                                      },
                                                                                                                                      "else": 0
                                                                                                                                    }
                                                                                                                                  },
                                                                                                                                  "in": {
                                                                                                                                    "$let": {
                                                                                                                                      "vars": {
                                                                                                                                        "r364": "$$value",
                                                                                                                                        "r365": "$$this"
                                                                                                                                      },
                                                                                                                                      "in": {
                                                                                                                                        "$switch": {
                                                                                                                                          "branches": [
                                                                                                                                            {
                                                                                                                                              "case": {
                                                                                                                                                "$eq": [
                                                                                                                                                  "$$operator",
                                                                                                                                                  "+"
                                                                                                                                                ]
                                                                                                                                              },
                                                                                                                                              "then": {
                                                                                                                                                "$add": [
                                                                                                                                                  "$$r364",
                                                                                                                                                  {
                                                                                                                                                    "$cond": {
                                                                                                                                                      "if": {
                                                                                                                                                        "$isNumber": "$$r365"
                                                                                                                                                      },
                                                                                                                                                      "then": "$$r365",
                                                                                                                                                      "else": 0
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                ]
                                                                                                                                              }
                                                                                                                                            },
                                                                                                                                            {
                                                                                                                                              "case": {
                                                                                                                                                "$eq": [
                                                                                                                                                  "$$operator",
                                                                                                                                                  "-"
                                                                                                                                                ]
                                                                                                                                              },
                                                                                                                                              "then": {
                                                                                                                                                "$subtract": [
                                                                                                                                                  "$$r364",
                                                                                                                                                  {
                                                                                                                                                    "$cond": {
                                                                                                                                                      "if": {
                                                                                                                                                        "$isNumber": "$$r365"
                                                                                                                                                      },
                                                                                                                                                      "then": "$$r365",
                                                                                                                                                      "else": 0
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                ]
                                                                                                                                              }
                                                                                                                                            }
                                                                                                                                          ],
                                                                                                                                          "default": "$$r364"
                                                                                                                                        }
                                                                                                                                      }
                                                                                                                                    }
                                                                                                                                  }
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        ]
                                                                                                                      },
                                                                                                                      {
                                                                                                                        "case": {
                                                                                                                          "$in": [
                                                                                                                            "$$operator",
                                                                                                                            [
                                                                                                                              "*",
                                                                                                                              "/"
                                                                                                                            ]
                                                                                                                          ]
                                                                                                                        },
                                                                                                                        "then": [
                                                                                                                          {
                                                                                                                            "$map": {
                                                                                                                              "input": "$$combinations",
                                                                                                                              "as": "r366",
                                                                                                                              "in": {
                                                                                                                                "$reduce": {
                                                                                                                                  "input": {
                                                                                                                                    "$slice": [
                                                                                                                                      "$$r366",
                                                                                                                                      1,
                                                                                                                                      {
                                                                                                                                        "$subtract": [
                                                                                                                                          {
                                                                                                                                            "$size": "$$r366"
                                                                                                                                          },
                                                                                                                                          1
                                                                                                                                        ]
                                                                                                                                      }
                                                                                                                                    ]
                                                                                                                                  },
                                                                                                                                  "initialValue": {
                                                                                                                                    "$cond": {
                                                                                                                                      "if": {
                                                                                                                                        "$isNumber": {
                                                                                                                                          "$first": "$$r366"
                                                                                                                                        }
                                                                                                                                      },
                                                                                                                                      "then": {
                                                                                                                                        "$first": "$$r366"
                                                                                                                                      },
                                                                                                                                      "else": 1
                                                                                                                                    }
                                                                                                                                  },
                                                                                                                                  "in": {
                                                                                                                                    "$let": {
                                                                                                                                      "vars": {
                                                                                                                                        "r367": "$$value",
                                                                                                                                        "r368": "$$this"
                                                                                                                                      },
                                                                                                                                      "in": {
                                                                                                                                        "$switch": {
                                                                                                                                          "branches": [
                                                                                                                                            {
                                                                                                                                              "case": {
                                                                                                                                                "$eq": [
                                                                                                                                                  "$$operator",
                                                                                                                                                  "*"
                                                                                                                                                ]
                                                                                                                                              },
                                                                                                                                              "then": {
                                                                                                                                                "$multiply": [
                                                                                                                                                  "$$r367",
                                                                                                                                                  {
                                                                                                                                                    "$cond": {
                                                                                                                                                      "if": {
                                                                                                                                                        "$isNumber": "$$r368"
                                                                                                                                                      },
                                                                                                                                                      "then": "$$r368",
                                                                                                                                                      "else": 1
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                ]
                                                                                                                                              }
                                                                                                                                            },
                                                                                                                                            {
                                                                                                                                              "case": {
                                                                                                                                                "$eq": [
                                                                                                                                                  "$$operator",
                                                                                                                                                  "/"
                                                                                                                                                ]
                                                                                                                                              },
                                                                                                                                              "then": {
                                                                                                                                                "$divide": [
                                                                                                                                                  "$$r367",
                                                                                                                                                  {
                                                                                                                                                    "$cond": {
                                                                                                                                                      "if": {
                                                                                                                                                        "$isNumber": "$$r368"
                                                                                                                                                      },
                                                                                                                                                      "then": "$$r368",
                                                                                                                                                      "else": 1
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                ]
                                                                                                                                              }
                                                                                                                                            }
                                                                                                                                          ],
                                                                                                                                          "default": "$$r367"
                                                                                                                                        }
                                                                                                                                      }
                                                                                                                                    }
                                                                                                                                  }
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        ]
                                                                                                                      }
                                                                                                                    ],
                                                                                                                    "default": "$$combinations"
                                                                                                                  }
                                                                                                                }
                                                                                                              }
                                                                                                            }
                                                                                                          }
                                                                                                        }
                                                                                                      ]
                                                                                                    },
                                                                                                    "stack": {
                                                                                                      "$cond": {
                                                                                                        "if": {
                                                                                                          "$lte": [
                                                                                                            {
                                                                                                              "$size": "$$r332.stack"
                                                                                                            },
                                                                                                            1
                                                                                                          ]
                                                                                                        },
                                                                                                        "then": [],
                                                                                                        "else": {
                                                                                                          "$slice": [
                                                                                                            "$$r332.stack",
                                                                                                            0,
                                                                                                            {
                                                                                                              "$subtract": [
                                                                                                                {
                                                                                                                  "$size": "$$r332.stack"
                                                                                                                },
                                                                                                                1
                                                                                                              ]
                                                                                                            }
                                                                                                          ]
                                                                                                        }
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                ]
                                                                                              }
                                                                                            }
                                                                                          }
                                                                                        }
                                                                                      }
                                                                                    }
                                                                                  },
                                                                                  "else": {
                                                                                    "$mergeObjects": [
                                                                                      "$$r332",
                                                                                      {
                                                                                        "value": {
                                                                                          "$concatArrays": [
                                                                                            "$$r332.value",
                                                                                            [
                                                                                              [
                                                                                                "$$r333"
                                                                                              ]
                                                                                            ]
                                                                                          ]
                                                                                        }
                                                                                      }
                                                                                    ]
                                                                                  }
                                                                                }
                                                                              }
                                                                            }
                                                                          }
                                                                        }
                                                                      },
                                                                      {
                                                                        "imports": {
                                                                          "$setUnion": [
                                                                            "$$r327.imports",
                                                                            [
                                                                              {
                                                                                "$ifNull": [
                                                                                  "$$imp.field",
                                                                                  {
                                                                                    "$toObjectId": "000000000000000000000000"
                                                                                  }
                                                                                ]
                                                                              }
                                                                            ],
                                                                            {
                                                                              "$reduce": {
                                                                                "input": {
                                                                                  "$range": [
                                                                                    0,
                                                                                    2
                                                                                  ]
                                                                                },
                                                                                "initialValue": [],
                                                                                "in": {
                                                                                  "$let": {
                                                                                    "vars": {
                                                                                      "r369": "$$value",
                                                                                      "r370": "$$this"
                                                                                    },
                                                                                    "in": {
                                                                                      "$cond": {
                                                                                        "if": {
                                                                                          "$toBool": {
                                                                                            "$arrayElemAt": [
                                                                                              "$$args",
                                                                                              "$$r370"
                                                                                            ]
                                                                                          }
                                                                                        },
                                                                                        "then": {
                                                                                          "$concatArrays": [
                                                                                            "$$r369",
                                                                                            [
                                                                                              {
                                                                                                "$toObjectId": {
                                                                                                  "$concat": [
                                                                                                    {
                                                                                                      "$toString": "$$imp.id"
                                                                                                    },
                                                                                                    "00000000000",
                                                                                                    {
                                                                                                      "$toString": "$$r370"
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              }
                                                                                            ]
                                                                                          ]
                                                                                        },
                                                                                        "else": "$$r369"
                                                                                      }
                                                                                    }
                                                                                  }
                                                                                }
                                                                              }
                                                                            }
                                                                          ]
                                                                        },
                                                                        "updated": {
                                                                          "$or": [
                                                                            "$$r327.updated",
                                                                            {
                                                                              "$toBool": "$$importedField.updated"
                                                                            }
                                                                          ]
                                                                        },
                                                                        "function": {
                                                                          "$concatArrays": [
                                                                            "$$r327.function",
                                                                            "$$next"
                                                                          ]
                                                                        }
                                                                      }
                                                                    ]
                                                                  }
                                                                }
                                                              }
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            },
                            "in": {
                              "result": {
                                "$reduce": {
                                  "input": "$$result.value",
                                  "initialValue": [],
                                  "in": {
                                    "$let": {
                                      "vars": {
                                        "r371": "$$value",
                                        "r372": "$$this"
                                      },
                                      "in": {
                                        "$concatArrays": [
                                          "$$r371",
                                          "$$r372"
                                        ]
                                      }
                                    }
                                  }
                                }
                              },
                              "imports": "$$result.imports",
                              "function": "$$result.function",
                              "nested": "$$result.nested",
                              "updated": "$$result.updated"
                            }
                          }
                        }
                      ]
                    }
                  ]
                ]
              }
            }
          }
        }
      }
    }
  },
  {
    "$set": {
      "compute": {
        "$reverseArray": "$$CURRENT.compute"
      }
    }
  },
  {
    "$set": {
      "values": {
        "$mergeObjects": [
          {
            "$reduce": {
              "input": "$$CURRENT.compute",
              "initialValue": "$$CURRENT.values",
              "in": {
                "$let": {
                  "vars": {
                    "r373": "$$value",
                    "r374": "$$this"
                  },
                  "in": {
                    "$cond": {
                      "if": {
                        "$and": [
                          {
                            "$eq": [
                              {
                                "$substrBytes": [
                                  {
                                    "$toString": "$$r374.k"
                                  },
                                  0,
                                  12
                                ]
                              },
                              "$$CURRENT.idString"
                            ]
                          },
                          {
                            "$ne": [
                              {
                                "$substrBytes": [
                                  {
                                    "$toString": "$$r374.k"
                                  },
                                  14,
                                  4
                                ]
                              },
                              "0000"
                            ]
                          }
                        ]
                      },
                      "then": {
                        "$mergeObjects": [
                          "$$r373",
                          {
                            "$arrayToObject": [
                              [
                                [
                                  {
                                    "$substrBytes": [
                                      {
                                        "$toString": "$$r374.k"
                                      },
                                      12,
                                      12
                                    ]
                                  },
                                  "$$r374.result"
                                ]
                              ]
                            ]
                          }
                        ]
                      },
                      "else": "$$r373"
                    }
                  }
                }
              }
            }
          }
        ]
      }
    }
  },
  {
    "$set": {
      "compute": {
        "$reduce": {
          "input": {
            "$concatArrays": [
              "$$CURRENT.compute",
              "$$CURRENT.updates",
              "$$CURRENT.derivatives"
            ]
          },
          "initialValue": [],
          "in": {
            "$let": {
              "vars": {
                "r375": "$$value",
                "r376": "$$this"
              },
              "in": {
                "$let": {
                  "vars": {
                    "parent": {
                      "$substrBytes": [
                        {
                          "$toString": "$$r376.k"
                        },
                        0,
                        12
                      ]
                    }
                  },
                  "in": {
                    "$let": {
                      "vars": {
                        "baseDepth": {
                          "$max": {
                            "$map": {
                              "input": {
                                "$filter": {
                                  "input": "$$r375",
                                  "as": "r377",
                                  "cond": {
                                    "$or": [
                                      {
                                        "$in": [
                                          "$$parent",
                                          "$$r377.nested"
                                        ]
                                      },
                                      {
                                        "$in": [
                                          "$$r376.k",
                                          "$$r377.imports"
                                        ]
                                      }
                                    ]
                                  }
                                }
                              },
                              "as": "r378",
                              "in": "$$r378.depth"
                            }
                          }
                        }
                      },
                      "in": {
                        "$cond": {
                          "if": {
                            "$or": [
                              {
                                "$isNumber": "$$baseDepth"
                              },
                              {
                                "$eq": [
                                  "$$parent",
                                  "$$CURRENT.idString"
                                ]
                              }
                            ]
                          },
                          "then": {
                            "$concatArrays": [
                              "$$r375",
                              [
                                {
                                  "$mergeObjects": [
                                    "$$r376",
                                    {
                                      "depth": {
                                        "$add": [
                                          {
                                            "$ifNull": [
                                              "$$baseDepth",
                                              0
                                            ]
                                          },
                                          1
                                        ]
                                      }
                                    }
                                  ]
                                }
                              ],
                              {
                                "$cond": {
                                  "if": {
                                    "$isArray": "$$r376._imports"
                                  },
                                  "then": {
                                    "$reduce": {
                                      "input": "$$r376._imports",
                                      "initialValue": [],
                                      "in": {
                                        "$let": {
                                          "vars": {
                                            "r379": "$$value",
                                            "r380": "$$this"
                                          },
                                          "in": {
                                            "$cond": {
                                              "if": {
                                                "$in": [
                                                  "$$r380.k",
                                                  "$$CURRENT.statics.k"
                                                ]
                                              },
                                              "then": "$$r379",
                                              "else": {
                                                "$concatArrays": [
                                                  "$$r379",
                                                  [
                                                    {
                                                      "$mergeObjects": [
                                                        "$$r380",
                                                        {
                                                          "imports": [],
                                                          "depth": {
                                                            "$add": [
                                                              "$$baseDepth",
                                                              1,
                                                              "$$r380.depth"
                                                            ]
                                                          }
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                ]
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  },
                                  "else": []
                                }
                              }
                            ]
                          },
                          "else": "$$r375"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "$set": {
      "compute": {
        "$reduce": {
          "input": "$$CURRENT.compute",
          "initialValue": [],
          "in": {
            "$let": {
              "vars": {
                "r381": "$$value",
                "r382": "$$this"
              },
              "in": {
                "$let": {
                  "vars": {
                    "search": {
                      "$reduce": {
                        "input": "$$r381",
                        "initialValue": {
                          "found": false,
                          "result": []
                        },
                        "in": {
                          "$let": {
                            "vars": {
                              "r383": "$$value",
                              "r384": "$$this"
                            },
                            "in": {
                              "$cond": {
                                "if": {
                                  "$and": [
                                    {
                                      "$gt": [
                                        "$$r382.depth",
                                        "$$r384.depth"
                                      ]
                                    },
                                    {
                                      "$not": "$$r383.found"
                                    }
                                  ]
                                },
                                "then": {
                                  "found": true,
                                  "result": {
                                    "$concatArrays": [
                                      "$$r383.result",
                                      [
                                        "$$r382",
                                        "$$r384"
                                      ]
                                    ]
                                  }
                                },
                                "else": {
                                  "found": "$$r383.found",
                                  "result": {
                                    "$concatArrays": [
                                      "$$r383.result",
                                      [
                                        "$$r384"
                                      ]
                                    ]
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  },
                  "in": {
                    "$cond": {
                      "if": "$$search.found",
                      "then": "$$search.result",
                      "else": {
                        "$concatArrays": [
                          "$$search.result",
                          [
                            "$$r382"
                          ]
                        ]
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "$set": {
      "compute": {
        "$reduce": {
          "input": "$$CURRENT.compute",
          "initialValue": [],
          "in": {
            "$let": {
              "vars": {
                "r385": "$$value",
                "r386": "$$this"
              },
              "in": {
                "$cond": {
                  "if": {
                    "$eq": [
                      {
                        "$type": {
                          "$first": {
                            "$filter": {
                              "input": "$$r385",
                              "as": "r387",
                              "cond": {
                                "$eq": [
                                  "$$r386.k",
                                  "$$r387.k"
                                ]
                              }
                            }
                          }
                        }
                      },
                      "object"
                    ]
                  },
                  "then": "$$r385",
                  "else": {
                    "$concatArrays": [
                      "$$r385",
                      [
                        "$$r386"
                      ]
                    ]
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "$set": {
      "revalidate": {
        "$cond": {
          "if": {
            "$isArray": "$$CURRENT.values.000005000000"
          },
          "then": {
            "page": 1679614462388,
            "layout": {
              "$cond": {
                "if": {
                  "$gt": [
                    {
                      "$size": {
                        "$setIntersection": [
                          {
                            "$concatArrays": [
                              "$$CURRENT.updates.k",
                              "$$CURRENT.derivatives.k"
                            ]
                          },
                          {
                            "$reduce": {
                              "input": {
                                "$reverseArray": "$$CURRENT.compute"
                              },
                              "initialValue": [],
                              "in": {
                                "$let": {
                                  "vars": {
                                    "r388": "$$value",
                                    "r389": "$$this"
                                  },
                                  "in": {
                                    "$cond": {
                                      "if": {
                                        "$or": [
                                          {
                                            "$eq": [
                                              "$$r389.k",
                                              {
                                                "$toObjectId": {
                                                  "$concat": [
                                                    "$$CURRENT.idString",
                                                    "000008000000"
                                                  ]
                                                }
                                              }
                                            ]
                                          },
                                          {
                                            "$in": [
                                              "$$r389.k",
                                              "$$r388"
                                            ]
                                          }
                                        ]
                                      },
                                      "then": {
                                        "$setUnion": [
                                          "$$r388",
                                          "$$r389.imports"
                                        ]
                                      },
                                      "else": "$$r388"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        ]
                      }
                    },
                    0
                  ]
                },
                "then": 1679614462388,
                "else": 0
              }
            },
            "fetchers": []
          },
          "else": "$$REMOVE"
        }
      }
    }
  },
  {
    "$unset": [
      "idString",
      "updates",
      "derivatives",
      "statics",
      "compute.result",
      "compute.imports",
      "compute.function",
      "compute._imports",
      "compute.depth",
      "compute.nested",
      "compute.updated"
    ]
  }
]